# src/types.ts Overview ðŸ“‘

This file defines core TypeScript **type aliases** that power the bundlerâ€™s plugin and output configuration system. It specifies:

- How **post-process hooks** behave (sync vs. async).
- The shape of **compiled output file paths**.
- Supported **module targets**.
- The structure of the **`exports`** field in `package.json`. 

---

## OutPutHook ðŸŽ¯

Represents a **post-process hook** for transforming bundled code. Hooks can be **synchronous** or **asynchronous**.

```ts
type OutPutHook =
  | { async: true;  func: (code: string, file?: string) => Promise<string> }
  | { async: false; func: (code: string, file?: string) => string };
```
- **async: true**  
  - `func` returns a `Promise<string>`.  
- **async: false**  
  - `func` returns `string` directly.  
- `code`: the bundled code to process.  
- `file?`: optional file path for context. 

Usage example:
```ts
import bannerText from "../banner-text"; // returns OutPutHook 
```

```card
{
  "title": "Hook Tip",
  "content": "Set `async: true` when using `await` inside your hook function."
}
```

---

## OutPutHookFunc ðŸ› ï¸

Alias for **hook factory functions**. A function that takes any arguments and returns an `OutPutHook`.

```ts
type OutPutHookFunc = (...args: any[]) => OutPutHook;
```
- Facilitates creating **configurable hooks** (e.g., `bannerText(license)`). 

---

## OutFiles ðŸ’¾

Describes all possible **output file paths** generated by the build.

| Property         | Type                | Description                                        |
|------------------|---------------------|----------------------------------------------------|
| `commonjs`       | `string \| undefined` | `.cjs` bundle path                                 |
| `commonjsTypes`  | `string \| undefined` | `.d.cts` type declaration for CommonJS             |
| `esm`            | `string \| undefined` | `.mjs` bundle path                                 |
| `esmTypes`       | `string \| undefined` | `.d.mts` type declaration for ESM                  |
| `main`           | `string \| undefined` | Value for `main` field in `package.json`           |
| `module`         | `string \| undefined` | Value for `module` field in `package.json`         |
| `types`          | `string \| undefined` | Value for `types` field in `package.json`          |

```ts
type OutFiles = {
  commonjs: string | undefined;
  commonjsTypes: string | undefined;
  esm: string | undefined;
  esmTypes: string | undefined;
  main: string | undefined;
  module: string | undefined;
  types: string | undefined;
};
```  
Imported by **compilers** to track outputs   
Consumed by **package writer** to update `package.json`   


---

## Target ðŸŽ¯

Specifies which **module formats** to emit.

```ts
type Target = "commonjs" | "esm" | "both";
```  
- `"commonjs"`: emit CJS only  
- `"esm"`: emit ESM only  
- `"both"`: emit both CJS and ESM  

Used in build options to drive compilation 

---

## Exports ðŸ“¦

Models the **`exports`** field structure in `package.json` for both ESM and CJS consumers.

```ts
type Exports = Record<
  string,
  {
    import?:  { default: string; types: string };
    require?: { default: string; types: string };
  }
>;
```  
- **Key**: subpath (e.g., `"."`, `"./plugin"`)  
- **import**: paths for ESM  
- **require**: paths for CJS  

Generated by the **getExports** logic to populate `package.json`   


---

These foundational types ensure a **consistent**, **type-safe** pipeline for bundling, post-processing, and packaging your library.